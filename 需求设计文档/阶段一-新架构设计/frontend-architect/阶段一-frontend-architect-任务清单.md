# 阶段一 - 前端架构（frontend-architect）任务清单

> 目标：围绕 PCB 编辑器 UI 与交互，把所有前端要落地的部分集中到一份清晰的任务列表中，避免分散在多份文档里。

## 0. 关联设计文档

- [00-架构总览与模块划分](../00-架构总览与模块划分.md)
- [01-UI框架与交互系统-详细设计](../01-UI框架与交互系统-详细设计.md)
- [02-核心数据与文件系统-详细设计](../02-核心数据与文件系统-详细设计.md)
- [05-历史记录系统-详细设计](../05-历史记录系统-详细设计.md)
- [06-属性系统与数据绑定-详细设计](../06-属性系统与数据绑定-详细设计.md)
- [EDA-阶段一-需求与任务分发](../EDA-阶段一-需求与任务分发.md)
- [UI-首屏壳层-任务分发/00-首屏壳层UI-需求与任务分发-frontend-architect](../UI-首屏壳层-任务分发/00-首屏壳层UI-需求与任务分发-frontend-architect.md)

---

## 1. PCB UI 布局与首屏壳层

1. 基于首屏壳层文档，实现整体应用框架：
   - 顶部菜单栏 / 工具栏 / 用户区域；
   - 左侧 Footprint/Net/Layer 面板；
   - 右侧属性面板；
   - 底部日志/DRC 面板；
   - 中央 PCB 画布容器（与 Canvas 内核对接）。
2. 抽象 `UILayout` / `PanelConfig` 结构：
   - 支持面板停靠 / 展开 / 收缩；
   - 支持后续保存布局配置。

## 2. 图层面板与当前层切换 UI

1. 实现 Layer 面板组件：
   - 展示层堆栈（名称、类型、顺序）；
   - 可见 / 锁定开关；
   - 当前编辑层高亮。
2. 通过事件总线向内核与渲染层广播当前层变更：
   - 设计 `LayerChanged` 等事件 Payload；
   - 与工具系统协作，确保布线等操作使用当前层。

## 3. Footprint 列表与工具栏

1. Footprint 列表面板：
   - 展示可用封装（支持占位数据）；
   - 点击 / 拖拽进入 Footprint 放置模式；
   - 与工具系统协作，切换到放置工具。
2. 工具栏组件：
   - 工具按钮：选择、放 Footprint、画线、放 Via、编辑板框；
   - 当前工具高亮与禁用态处理；
   - 与快捷键系统联动。

## 4. 属性面板与 PropertyAdapter 对接

1. 实现属性面板 UI 框架：
   - 基于 Schema 的动态表单（支持分组与折叠）；
   - 支持单选 / 多选实体；
   - 支持不同实体类型混选时的字段合并规则。
2. 为以下实体实现 PropertyAdapter 对接：
   - Footprint / Pad / Track / Via / BoardOutline；
3. 属性修改走命令链路：
   - 表单提交生成 `PropertyChangeCommand`；
   - 将命令发送到内核 HistoryManager。

## 5. 快捷键系统（UI 侧）

1. 设计并实现快捷键配置与分发模块：
   - 区分 UI 快捷键与内核快捷键；
   - 支持快捷键配置表（JSON）加载与更新；
   - 提供冲突检测与回退机制。
2. 将以下操作接入快捷键：
   - 视图：缩放、平移复位、缩放到板框；
   - 编辑：撤销/重做、切换当前层、切换工具（选择/放 Footprint/走线/放 Via）；
   - PCB 特有：旋转/镜像 Footprint，开始/结束布线等。

## 6. 右键菜单与命令面板

1. 实现数据驱动的右键菜单组件：
   - 支持根据命中实体类型（空白、Footprint、Track、Via 等）动态生成菜单；
   - 菜单项通过 Command 描述（id、label、payloadSchema）。
2. 对接 graphics-engineer 提供的 `parseContextMenu` 能力：
   - 将命中结果与上下文交给内核生成菜单描述；
   - 菜单点击后触发相应命令。

## 7. 历史记录 UI 与状态可视化

1. 基于 HistoryManager 实现基础的撤销/重做 UI：
   - 顶部工具栏上的 Undo/Redo 按钮；
   - 快捷键 Ctrl+Z / Ctrl+Y 对接；
2. 可选：实现简单的历史记录面板：
   - 展示最近若干命令的列表；
   - 当前时间线位置高亮。

## 8. 状态与事件总线集成

1. 设计前端状态层：
   - 当前选中实体集合；
   - 当前工具 / 当前层 / 视图状态；
2. 与事件总线 / Pub-Sub 集成：
   - 订阅内核发出的选择变更 / 文档加载 / 历史记录更新事件；
   - 发布用户交互事件（工具切换、快捷键触发等）。

## 9. QA 支持与可测试性

1. 为关键交互提供可脚本化的触发入口：
   - 例如通过命令面板或调试面板触发某些工具与操作；
2. 与 qa-automation-expert 对齐：
   - 给出 UI 层可观测的状态点（DOM 标识、可查询的状态 API），方便自动化测试脚本编写。

